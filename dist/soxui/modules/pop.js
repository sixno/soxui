(function(){"use strict";function e(){this.version="1.0.0";this.modules=["tpl"];if(typeof soxui!="undefined"&&soxui.$){var u=soxui.$}else{if(typeof jQuery=="undefined"){typeof console=="object"&&console.error("soxpop error: sorry, jQuery is required, you must load it before this script.");return false}if(typeof soxui=="undefined")window["soxui"]={};for(var e in this.modules){if(typeof window["sox"+this.modules[e]]=="undefined"){typeof console=="object"&&console.error("soxpop error: sorry, sox"+this.modules[e]+" is required, you must load it before this script.");return false}window["soxui"][this.modules[e]]=window["sox"+this.modules[e]]}}var t="";var i="";var f=false;t=document.currentScript?document.currentScript.src:function(){if(soxui.base){return soxui.base+"modules/pop.js"}else{for(var e=document.scripts.length-1;e>0;e--){if(document.scripts[e].src.indexOf("/soxui/modules/pop.js")>0)return document.scripts[e].src}}return document.scripts[0].src}();i=t.substring(0,t.lastIndexOf("/")-7)+"templates/pop.html?v="+this.version+"."+Date.parse(new Date);var a=function(t){u.ajax({async:true,type:"GET",url:i,success:function(e){f=soxui.tpl.create(e);if(typeof t=="function")t()},error:function(){typeof console=="object"&&console.error("soxpop error: can`t find the template.")},dataType:"html"})};var h=u(window);var p={getPath:t,config:{},end:{},minIndex:0,minLeft:[],btn:["&#x786E;&#x5B9A;","&#x53D6;&#x6D88;"],type:["dialog","page","iframe","loading","tips"]};var m={ie:function(){var e=navigator.userAgent.toLowerCase();return!!window.ActiveXObject||"ActiveXObject"in window?(e.match(/msie\s(\d+)/)||[])[1]||"11":false}(),index:0,path:p.getPath,config:{},open:function(e){var t=new o(e);m.config=t.config;return t.index},alert:function(e,t,i){var o=typeof t==="function";if(o)i=t;return m.open(u.extend({content:e,yes:i},o?{}:t))},confirm:function(e,t,i,o){var s=typeof t==="function";if(s){o=i;i=t}return m.open(u.extend({content:e,btn:p.btn,yes:i,btn2:o},s?{}:t))},msg:function(e,t,i){var o=typeof t==="function",s=p.config.skin;var n=(s?s+" "+s+"-msg":"")||"sox-layer-msg";var r=l.anim.length-1;if(o)i=t;return m.open(u.extend({nomc:true,content:e,time:3e3,shade:false,skin:n,title:false,closeBtn:false,btn:false,resize:false,end:i},o&&!p.config.skin?{skin:n+" sox-layer-hui",anim:r}:function(){t=t||{};if(t.icon===-1||t.icon===undefined&&!p.config.skin){t.skin=n+" "+(t.skin||"sox-layer-hui")}return t}()))},load:function(e,t){return m.open(u.extend({type:3,icon:e||0,resize:false,shade:.01},t))},tips:function(e,t,i){return m.open(u.extend({type:4,nomc:true,content:e,follow:t,closeBtn:false,time:3e3,shade:false,resize:false,fixed:false,maxWidth:210},i))}};this.open=m.open;this.alert=m.alert;this.confirm=m.confirm;this.msg=m.msg;this.load=m.load;this.tips=m.tips;var o=function(e){var t=this;t.index=++m.index;t.config=u.extend({},t.config,p.config,e);document.body?t.creat():setTimeout(function(){t.creat()},30)};o.pt=o.prototype;var l=["sox-layer",".sox-layer-header",".sox-layer-footer",".sox-layer-dialog","sox-layer-iframe","sox-layer-content","sox-layer-btn","sox-layer-close"];l.anim=["layer-anim-00","layer-anim-01","layer-anim-02","layer-anim-03","layer-anim-04","layer-anim-05","layer-anim-06"];l.html=u("html");o.pt.config={type:0,shade:.3,fixed:true,move:l[1],title:"",content:"",follow:"body",scroll:"auto",offset:"auto",area:"auto",closeBtn:1,time:0,zIndex:19900608,maxWidth:360,anim:0,isOutAnim:true,icon:-1,moveType:1,resize:false,scrollbar:true,tips:2,border_fix:2};o.pt.vessel=function(e){var t=this;var i=t.index;var o=t.config;var s=o.zIndex+i;var n=o;n.ready=p;n.times=i;n.ismax=o.maxmin&&(o.type===1||o.type===2);n.zIndex=s;var r=[o.shade?'<div class="sox-layer-shade" id="sox-layer-shade'+i+'" times="'+i+'" style="'+("z-index:"+(s-1)+"; ")+'"></div>':""];if(f){r.push(soxui.tpl.render(f,n));e(r,u('<div class="sox-layer-move"></div>'))}else{a(function(){r.push(soxui.tpl.render(f,n));e(r,u('<div class="sox-layer-move"></div>'))})}return t};o.pt.creat=function(){var o=this,s=o.config,n=o.index,e,t=s.content,r=u("body");if(s.id&&u("#"+s.id)[0])return;if(typeof s.area==="string"){s.area=s.area==="auto"?["",""]:[s.area,""]}if(s.shift){s.anim=s.shift}if(m.ie==6){s.fixed=false}switch(s.type){case 0:s.btn="btn"in s?s.btn:p.btn[0];m.closeAll("dialog");break;case 3:delete s.title;delete s.closeBtn;s.icon===-1&&s.icon===0;m.closeAll("loading");break;case 4:s.content=s.content+'<i class="sox-layer-TipsG"></i>';delete s.title;s.tips=typeof s.tips==="object"?s.tips:[s.tips,true];s.tipsMore||m.closeAll("tips");break}o.vessel(function(e,t){r.append(e[0]);r.append(e[1]);u(".sox-layer-move")[0]||r.append(p.moveElem=t);o.layero=u("#"+l[0]+n);s.scrollbar||l.html.css("overflow","hidden").attr("layer-full",n);u("#sox-layer-shade"+o.index).css({"background-color":s.shade[1]||"#000",opacity:s.shade[0]||s.shade});s.type==2&&m.ie==6&&o.layero.find("iframe").attr("src",s.content);s.type==4?o.tips():o.offset();if(s.fixed){h.on("resize",function(){o.offset();(/^\d+%$/.test(s.area[0])||/^\d+%$/.test(s.area[1]))&&o.auto(n);s.type==4&&o.tips()})}s.time<=0||setTimeout(function(){m.close(o.index)},s.time);o.move().callback();if(l.anim[s.anim]){var i="layer-anim "+l.anim[s.anim];o.layero.addClass(i).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){u(this).removeClass(i)})}if(s.isOutAnim){o.layero.data("isOutAnim",true)}}).auto(n)};o.pt.auto=function(e){var t=this,i=t.config,o=u("#"+l[0]+e);if(i.area[0]===""&&i.maxWidth>0){if(m.ie&&m.ie<8&&i.btn){o.width(o.innerWidth())}o.outerWidth()>i.maxWidth&&o.width(i.maxWidth)}var s=[o.innerWidth(),o.innerHeight()],n=o.find(l[1]).outerHeight()||0,r=o.find(l[2]).outerHeight()||0,f=function(e){e=o.find(e);e.height(s[1]-n-r-2*(parseFloat(e.css("padding-top"))|0))};switch(i.type){case 2:f("iframe");break;default:if(i.area[1]===""){if(i.maxHeight>0&&o.outerHeight()>i.maxHeight){s[1]=i.maxHeight;f("."+l[5])}else if(i.fixed&&s[1]>=h.height()){s[1]=h.height();f("."+l[5])}}else{f("."+l[5])}break}return t};o.pt.offset=function(){var e=this,t=e.config,i=e.layero;var o=[i.outerWidth(),i.outerHeight()];var s=typeof t.offset==="object";e.offsetTop=(h.height()-o[1])/2;e.offsetLeft=(h.width()-o[0])/2;if(s){e.offsetTop=t.offset[0];e.offsetLeft=t.offset[1]||e.offsetLeft}else if(t.offset!=="auto"){if(t.offset==="t"){e.offsetTop=0}else if(t.offset==="r"){e.offsetLeft=h.width()-o[0]}else if(t.offset==="b"){e.offsetTop=h.height()-o[1]}else if(t.offset==="l"){e.offsetLeft=0}else if(t.offset==="lt"){e.offsetTop=0;e.offsetLeft=0}else if(t.offset==="lb"){e.offsetTop=h.height()-o[1];e.offsetLeft=0}else if(t.offset==="rt"){e.offsetTop=0;e.offsetLeft=h.width()-o[0]}else if(t.offset==="rb"){e.offsetTop=h.height()-o[1];e.offsetLeft=h.width()-o[0]}else{e.offsetTop=t.offset}}if(!t.fixed){e.offsetTop=/%$/.test(e.offsetTop)?h.height()*parseFloat(e.offsetTop)/100:parseFloat(e.offsetTop);e.offsetLeft=/%$/.test(e.offsetLeft)?h.width()*parseFloat(e.offsetLeft)/100:parseFloat(e.offsetLeft);e.offsetTop+=h.scrollTop();e.offsetLeft+=h.scrollLeft()}if(i.attr("minLeft")){e.offsetTop=h.height()-(i.find(l[1]).outerHeight()||0);e.offsetLeft=i.css("left")}i.css({top:e.offsetTop,left:e.offsetLeft})};o.pt.tips=function(){var e=this,t=e.config,i=e.layero;var o=[i.outerWidth(),i.outerHeight()],s=u(t.follow);if(!s[0])s=u("body");var n={width:s.outerWidth(),height:s.outerHeight(),top:s.offset().top,left:s.offset().left},r=i.find(".sox-layer-TipsG");var f=t.tips[0];t.tips[1]||r.remove();n.autoLeft=function(){if(n.left+o[0]-h.width()>0){n.tipLeft=n.left+n.width-o[0];r.css({right:12,left:"auto"})}else{n.tipLeft=n.left}};n.where=[function(){n.autoLeft();n.tipTop=n.top-o[1]-10;r.removeClass("sox-layer-TipsB").addClass("sox-layer-TipsT").css("border-right-color",t.tips[1])},function(){n.tipLeft=n.left+n.width+10;n.tipTop=n.top;r.removeClass("sox-layer-TipsL").addClass("sox-layer-TipsR").css("border-bottom-color",t.tips[1])},function(){n.autoLeft();n.tipTop=n.top+n.height+10;r.removeClass("sox-layer-TipsT").addClass("sox-layer-TipsB").css("border-right-color",t.tips[1])},function(){n.tipLeft=n.left-o[0]-10;n.tipTop=n.top;r.removeClass("sox-layer-TipsR").addClass("sox-layer-TipsL").css("border-bottom-color",t.tips[1])}];n.where[f-1]();if(f===1){n.top-(h.scrollTop()+o[1]+8*2)<0&&n.where[2]()}else if(f===2){h.width()-(n.left+n.width+o[0]+8*2)>0||n.where[3]()}else if(f===3){n.top-h.scrollTop()+n.height+o[1]+8*2-h.height()>0&&n.where[0]()}else if(f===4){o[0]+8*2-n.left>0&&n.where[1]()}i.find("."+l[5]).css({"background-color":t.tips[1],"padding-right":t.closeBtn?"30px":""});i.css({left:n.tipLeft-(t.fixed?h.scrollLeft():0),top:n.tipTop-(t.fixed?h.scrollTop():0)})};o.pt.move=function(){var a=this,l=a.config,e=u(document),c=a.layero,t=c.find(l.move),i=c.find(".sox-layer-resize"),d={};if(l.move){t.css("cursor","move")}t.on("mousedown",function(e){e.preventDefault();if(l.move){d.moveStart=true;d.offset=[e.clientX-parseFloat(c.css("left")),e.clientY-parseFloat(c.css("top"))];p.moveElem.css("cursor","move").show()}});i.on("mousedown",function(e){e.preventDefault();d.resizeStart=true;d.offset=[e.clientX,e.clientY];d.area=[c.outerWidth(),c.outerHeight()];p.moveElem.css("cursor","se-resize").show()});e.on("mousemove",function(e){if(d.moveStart){var t=e.clientX-d.offset[0],i=e.clientY-d.offset[1],o=c.css("position")==="fixed";e.preventDefault();d.stX=o?0:h.scrollLeft();d.stY=o?0:h.scrollTop();if(!l.moveOut){var s=h.width()-c.outerWidth()+d.stX,n=h.height()-c.outerHeight()+d.stY;t<d.stX&&(t=d.stX);t>s&&(t=s);i<d.stY&&(i=d.stY);i>n&&(i=n)}c.css({left:t,top:i})}if(l.resize&&d.resizeStart){var t=e.clientX-d.offset[0],i=e.clientY-d.offset[1];e.preventDefault();var r=c.attr("ini-width");var f=c.attr("ini-height");if(!r){r=d.area[0];c.attr("ini-width",r)}if(!f){f=d.area[1];c.attr("ini-height",f)}d.stX=o?0:h.scrollLeft();d.stY=o?0:h.scrollTop();if(!l.moveOut){d.area[0]+t<r&&(t=r-d.area[0]);d.area[0]+t>h.width()-c.offset().left&&(t=h.width()-c.offset().left-d.area[0]);d.area[1]+i<f&&(i=f-d.area[1]);d.area[1]+i>h.height()-c.offset().top&&(i=h.height()-c.offset().top-d.area[1])}m.style(a.index,{width:d.area[0]+t,height:d.area[1]+i});d.isResize=true;l.resizing&&l.resizing(c)}}).on("mouseup",function(e){if(d.moveStart){delete d.moveStart;p.moveElem.hide();l.moveEnd&&l.moveEnd(c)}if(d.resizeStart){delete d.resizeStart;p.moveElem.hide()}});return a};o.pt.callback=function(){var i=this,o=i.layero,s=i.config;i.openLayer();if(s.success){if(s.type==2){o.find("iframe").on("load",function(){s.success(o,i.index)})}else{s.success(o,i.index)}}m.ie==6&&i.IE6(o);o.find("."+l[6]).children("a").on("click",function(){var e=u(this).index();if(e===0){if(s.yes){s.yes(i.index,o)}else if(s["btn1"]){s["btn1"](i.index,o)}else{m.close(i.index)}}else{var t=s["btn"+(e+1)]&&s["btn"+(e+1)](i.index,o);t===false||m.close(i.index)}});function e(){var e=s.cancel&&s.cancel(i.index,o);e===false||m.close(i.index)}o.find("."+l[7]).on("click",e);if(s.shadeClose){u("#sox-layer-shade"+i.index).on("click",function(){m.close(i.index)})}o.find(".sox-layer-min").on("click",function(){var e=s.min&&s.min(o);e===false||m.min(i.index,s)});o.find(".sox-layer-max").on("click",function(){if(u(this).hasClass("sox-layer-maxmin")){m.restore(i.index);s.restore&&s.restore(o)}else{m.full(i.index,s);setTimeout(function(){s.full&&s.full(o)},100)}});s.end&&(p.end[i.index]=s.end)};p.reselect=function(){u.each(u("select"),function(e,t){var i=u(this);if(!i.parents("."+l[0])[0]){i.attr("layer")==1&&u("."+l[0]).length<1&&i.removeAttr("layer").show()}i=null})};o.pt.IE6=function(e){u("select").each(function(e,t){var i=u(this);if(!i.parents("."+l[0])[0]){i.css("display")==="none"||i.attr({layer:"1"}).hide()}i=null})};o.pt.openLayer=function(){var e=this;m.zIndex=e.config.zIndex;m.setTop=function(e){var t=function(){m.zIndex++;e.css("z-index",m.zIndex+1)};m.zIndex=parseInt(e[0].style.zIndex);e.on("mousedown",t);return m.zIndex}};p.record=function(e){var t=[e.width(),e.height(),e.position().top,e.position().left+parseFloat(e.css("margin-left"))];e.find(".sox-layer-max").addClass("sox-layer-maxmin");e.attr({area:t})};p.rescollbar=function(e){if(l.html.attr("layer-full")==e){if(l.html[0].style.removeProperty){l.html[0].style.removeProperty("overflow")}else{l.html[0].style.removeAttribute("overflow")}l.html.removeAttr("layer-full")}};this.getChildFrame=m.getChildFrame=function(e,t){t=t||u("."+l[4]).attr("times");return u("#"+l[0]+t).find("iframe").contents().find(e)};this.getFrameIndex=m.getFrameIndex=function(e){return u("#"+e).parents("."+l[4]).attr("times")};this.iframeAuto=m.iframeAuto=function(e){if(!e)return;var t=m.getChildFrame("html",e).outerHeight();var i=u("#"+l[0]+e);var o=i.find(l[1]).outerHeight()||0;var s=i.find(l[2]).outerHeight()||0;i.css({height:t+o+s});i.find("iframe").css({height:t})};this.iframeSrc=m.iframeSrc=function(e,t){u("#"+l[0]+e).find("iframe").attr("src",t)};this.style=m.style=function(e,t){var i=u("#"+l[0]+e),o=this.config,s=i.find(".sox-layer-mainer"),n=i.attr("type"),r=i.find(l[1]).outerHeight()||0,f=i.find(l[2]).outerHeight()||0,a=i.attr("minLeft");if(n===p.type[3]||n===p.type[4]){return}i.css(t);f=i.find(".sox-layer-footer").outerHeight();if(n===p.type[2]){i.find("iframe").css({height:parseFloat(t.height)-r-f-o.border_fix})}else{s.css({height:parseFloat(t.height)-r-f-o.border_fix})}};this.min=m.min=function(e,t){var i=u("#"+l[0]+e),o=i.find(l[1]).outerHeight()||0,s=i.attr("minLeft")||181*p.minIndex+"px",n=i.css("position");p.record(i);if(p.minLeft[0]){s=p.minLeft[0];p.minLeft.shift()}i.attr("position",n);m.style(e,{width:180,height:o,left:s,top:h.height()-o,position:"fixed",overflow:"hidden"},true);i.find(".sox-layer-min").hide();i.attr("type")==="page"&&i.find(l[4]).hide();p.rescollbar(e);if(!i.attr("minLeft")){p.minIndex++}i.attr("minLeft",s)};this.restore=m.restore=function(e){var t=u("#"+l[0]+e),i=t.attr("area").split(",");var o=t.attr("type");m.style(e,{width:parseFloat(i[0]),height:parseFloat(i[1]),top:parseFloat(i[2]),left:parseFloat(i[3]),position:t.attr("position"),overflow:"visible"},true);t.find(".sox-layer-max").removeClass("sox-layer-maxmin");t.find(".sox-layer-min").show();t.attr("type")==="page"&&t.find(l[4]).show();p.rescollbar(e)};this.full=m.full=function(t){var i=u("#"+l[0]+t),e;p.record(i);if(!l.html.attr("layer-full")){l.html.css("overflow","hidden").attr("layer-full",t)}clearTimeout(e);e=setTimeout(function(){var e=i.css("position")==="fixed";m.style(t,{top:e?0:h.scrollTop(),left:e?0:h.scrollLeft(),width:h.width(),height:h.height()},true);i.find(".sox-layer-min").hide()},100)};this.title=m.title=function(e,t){var i=u("#"+l[0]+(t||m.index)).find(l[1]);i.html(e)};this.close=m.close=function(t){var i=u("#"+l[0]+t),o=i.attr("type"),e="layer-anim-close";if(!i[0])return;var s="sox-layer-wrap",n=function(){if(o===p.type[2]){try{var e=u("#"+l[4]+t)[0];e.contentWindow.document.write("");e.contentWindow.close();i.find("."+l[5])[0].removeChild(e)}catch(e){}}i[0].innerHTML="";i.remove();typeof p.end[t]==="function"&&p.end[t]();delete p.end[t];if(u(".sox-layer").length==0){u(".sox-layer-move").remove();m.index=0}};if(i.data("isOutAnim")){i.addClass("layer-anim "+e)}u("#sox-layer-moves, #sox-layer-shade"+t).remove();m.ie==6&&p.reselect();p.rescollbar(t);if(i.attr("minLeft")){p.minIndex--;p.minLeft.push(i.attr("minLeft"))}if(m.ie&&m.ie<10||!i.data("isOutAnim")){n()}else{setTimeout(function(){n()},200)}};this.closeAll=m.closeAll=function(i){u.each(u("."+l[0]),function(){var e=u(this);var t=i?e.attr("type")===i:1;t&&m.close(e.attr("times"));t=null})};return this}if(typeof soxui!="undefined"){soxui.pop=new e}else{window.soxpop=new e}})();